<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="./common/_layui_common :: common_header">
    <meta charset="UTF-8">
</head>
<body>
<div class="layuimini-main">
    <div class="layui-card">
        <div class="layui-card-header"><i class="fa fa-line-chart icon"></i>体重数据</div>
        <div class="layui-card-body">
            <div id="echarts-records" style="width: 100%;min-height:500px"></div>
        </div>
    </div>
</div>
<div th:replace="./common/_layui_common::common_js"></div>
<script>
    layui.use(['form', 'table', 'laydate', 'layer'], function () {
        const $ = layui.jquery,
            form = layui.form,
            table = layui.table,
            laydate = layui.laydate;

        //起始日期
        laydate.render({
            elem: '#startDay'
        });

        //结束日期
        laydate.render({
            elem: '#endDay'
        });

        // 监听搜索操作
        form.on('submit(data-search-btn)', function (data) {
            const test = [131, 40, 228, 541, 412, 109, 70];
            console.log(test);
            initTradeRecordCharts(test);
            return false;
        });

        // 监听清空操作
        form.on('submit(data-clear-btn)', function (data) {
            return false;
        });

        //监听表格复选框选择
        table.on('checkbox(currentTableFilter)', function (obj) {
            console.log(obj)
        });
    });

    $(function () {
        initIncomeStatisCharts();
    });

    /**
     * 体重曲线图表初始化
     */
    function initIncomeStatisCharts() {

        $.post("/statis/health/weight-info", function (result) {
            if (result.success) {
                const options = {
                    series: [{
                        name: '体重',
                        data: result.data.weights
                    }],
                    chart: {
                        height: 350,
                        type: 'area'
                    },
                    dataLabels: {
                        enabled: false
                    },
                    stroke: {
                        curve: 'smooth'
                    },
                    xaxis: {
                        type: 'date',
                        categories: result.data.date
                    },
                    tooltip: {
                        x: {
                            format: 'yyyy-MM-dd'
                        }
                    },
                };

                const chart = new ApexCharts(document.querySelector("#echarts-records"), options);
                chart.render();
            }
        }, "JSON");
    }
</script>
</body>
</html>